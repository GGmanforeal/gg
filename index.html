<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SAT Reading & Writing Strategy Nexus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base Settings */
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f8fafc; 
            -webkit-tap-highlight-color: transparent; /* Remove tap highlight on iOS */
        }

        /* Chart Container - Mobile First Logic */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px; /* Default height */
        }
        
        /* Adjust chart height for larger screens */
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Active State Styling */
        .theme-btn.active {
            background-color: #eff6ff;
            color: #2563eb;
            border-left-color: #2563eb;
            font-weight: 600;
        }
        
        /* Scrollbar Styling for Desktop Sidebar */
        .sidebar-scroll::-webkit-scrollbar { width: 6px; }
        .sidebar-scroll::-webkit-scrollbar-track { background: transparent; }
        .sidebar-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

        /* Smooth Scrolling */
        html { scroll-behavior: smooth; }
    </style>
</head>
<body class="text-slate-800 min-h-screen flex flex-col">

    <!-- Application Structure Plan:
         MOBILE UPDATE:
         1. Layout: Switched from "h-screen overflow-hidden" to "min-h-screen" to allow natural scrolling on iOS.
            This prevents the bottom address bar from hiding content.
         2. Navigation: Sticky Sidebar for Desktop, Standard document flow for Mobile to ensure stability.
         3. Touch: Larger hit areas for all interactive elements.
    -->
    
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <!-- Chosen Palette: "Smart Blue" - Consistent with previous version. -->

    <!-- Header: Sticky on Mobile for easy access to status -->
    <header class="bg-white border-b border-slate-200 p-4 shadow-sm sticky top-0 z-50 md:relative">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-3 md:gap-4">
            <!-- Logo Section -->
            <div class="flex items-center gap-3 w-full md:w-auto">
                <div class="bg-blue-600 text-white font-bold rounded-lg w-9 h-9 flex items-center justify-center text-lg shadow-sm">S</div>
                <div class="leading-tight">
                    <h1 class="font-bold text-lg md:text-xl text-slate-900">SAT Strategy Nexus</h1>
                    <p class="text-[10px] md:text-xs text-slate-500 uppercase tracking-wide">Reading & Writing Mastery</p>
                </div>
            </div>
            
            <!-- Progress Section -->
            <div class="w-full md:w-1/3 flex flex-col gap-1">
                <div class="flex justify-between text-xs font-semibold text-slate-600">
                    <span>Mastery Progress</span>
                    <span id="progress-text">0%</span>
                </div>
                <div class="w-full bg-slate-100 rounded-full h-2.5 overflow-hidden">
                    <div id="progress-bar" class="bg-emerald-500 h-2.5 rounded-full transition-all duration-500 ease-out" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Wrapper -->
    <div class="flex flex-col md:flex-row flex-1 max-w-7xl mx-auto w-full">
        
        <!-- Mobile Navigation (Dropdown) - Visible only on small screens -->
        <div class="md:hidden w-full bg-white border-b border-slate-200 p-4 sticky top-[73px] z-40 shadow-sm">
            <label for="mobile-nav" class="block text-xs font-bold text-slate-500 uppercase mb-1">Select Topic</label>
            <div class="relative">
                <select id="mobile-nav" class="w-full p-3 pr-8 border border-slate-300 rounded-lg bg-slate-50 text-slate-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none">
                    <!-- Options injected by JS -->
                </select>
                <!-- Custom Arrow for Select -->
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-500">
                    <span class="text-xs">&#9660;</span>
                </div>
            </div>
        </div>

        <!-- Desktop Sidebar - Visible only on medium+ screens -->
        <aside class="hidden md:flex flex-col w-64 border-r border-slate-200 bg-white md:h-[calc(100vh-80px)] md:sticky md:top-0">
            <div class="p-4 border-b border-slate-100 bg-slate-50">
                <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider">Exam Themes</h3>
            </div>
            <nav id="sidebar-nav" class="flex-1 overflow-y-auto sidebar-scroll p-2 space-y-1">
                <!-- Nav items injected by JS -->
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 bg-slate-50 p-4 md:p-8 w-full min-h-[80vh]" id="main-content-area">
            
            <!-- Welcome View -->
            <div id="welcome-view" class="max-w-2xl mx-auto text-center space-y-6 py-8 md:py-16 px-2">
                <div class="inline-flex items-center justify-center w-20 h-20 bg-blue-100 rounded-full text-blue-600 text-4xl mb-2 shadow-sm">
                    &#128218;
                </div>
                <h2 class="text-2xl md:text-4xl font-bold text-slate-900 tracking-tight">Master the Digital SAT</h2>
                <p class="text-slate-600 text-base md:text-lg leading-relaxed">
                    Select a theme from the menu to unlock expert strategies, analyze skill requirements, and track your progress.
                </p>
                <!-- Quick Cards for Mobile Visual Appeal -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-left mt-8">
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200">
                        <h4 class="font-bold text-slate-800 mb-1">Craft & Structure</h4>
                        <p class="text-sm text-slate-500">Words in Context, Text Structure, Connections.</p>
                    </div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200">
                        <h4 class="font-bold text-slate-800 mb-1">Standard Conventions</h4>
                        <p class="text-sm text-slate-500">Grammar, Boundaries, Form & Sense.</p>
                    </div>
                </div>
            </div>

            <!-- Dynamic Theme View -->
            <div id="theme-view" class="hidden max-w-5xl mx-auto space-y-6 pb-12">
                
                <!-- Theme Header Card -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 md:p-6">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                        <div>
                            <span class="inline-block px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-[10px] md:text-xs font-bold uppercase tracking-wide mb-2" id="theme-category">Category</span>
                            <h2 class="text-2xl md:text-3xl font-bold text-slate-900 leading-tight" id="theme-title">Theme Title</h2>
                            <p class="text-sm md:text-base text-slate-500 mt-2" id="theme-description">Brief description of what this theme covers.</p>
                        </div>
                        
                        <!-- Mastered Button -->
                        <button id="mark-mastered-btn" class="w-full md:w-auto px-6 py-3.5 rounded-lg font-semibold transition-all duration-200 flex items-center justify-center gap-2 shadow-sm border active:scale-95 touch-manipulation">
                            <span id="mastered-icon" class="text-xl">&#9675;</span>
                            <span id="mastered-text">Mark as Mastered</span>
                        </button>
                    </div>
                </div>

                <!-- Content Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    
                    <!-- Left Column: Content (Order 2 on mobile to show chart first? No, strategy first is better) -->
                    <div class="lg:col-span-2 space-y-6 order-2 lg:order-1">
                        
                        <!-- Strategies -->
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                            <div class="bg-slate-50 border-b border-slate-100 px-5 py-4">
                                <h3 class="font-bold text-slate-800 flex items-center gap-2">
                                    <span class="text-blue-500 bg-blue-100 w-6 h-6 rounded flex items-center justify-center text-sm">&#9889;</span> 
                                    High-Yield Strategies
                                </h3>
                            </div>
                            <div class="p-5 md:p-6">
                                <div class="prose prose-slate prose-sm md:prose-base max-w-none text-slate-600 space-y-4" id="strategy-content">
                                    <!-- Dynamic Content -->
                                </div>
                            </div>
                        </div>

                        <!-- Traps -->
                        <div class="bg-rose-50 rounded-xl border border-rose-100 p-5 md:p-6">
                            <h4 class="text-rose-800 font-bold mb-4 flex items-center gap-2">
                                <span class="text-lg">&#9888;</span> Common Traps
                            </h4>
                            <ul class="space-y-3 text-rose-800 text-sm md:text-base" id="traps-list">
                                <!-- Dynamic List -->
                            </ul>
                        </div>

                    </div>

                    <!-- Right Column: Visuals & Tips -->
                    <div class="space-y-6 order-1 lg:order-2">
                        
                        <!-- Radar Chart -->
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4">
                            <div class="mb-2 text-center">
                                <h4 class="font-bold text-slate-700 text-xs uppercase tracking-wide">Skill Profile</h4>
                            </div>
                            <!-- Container ensures chart doesn't overflow or squash on mobile -->
                            <div class="chart-container mx-auto">
                                <canvas id="skillRadarChart"></canvas>
                            </div>
                        </div>

                        <!-- Pro Tip -->
                        <div class="bg-indigo-50 rounded-xl border border-indigo-100 p-5 shadow-sm">
                            <div class="flex items-start gap-3">
                                <span class="text-2xl mt-1">&#128161;</span>
                                <div>
                                    <h5 class="font-bold text-indigo-900 text-sm mb-1">Pro Tip</h5>
                                    <p class="text-indigo-800 text-sm italic leading-relaxed" id="pro-tip">
                                        Loading tip...
                                    </p>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

        </main>
    </div>

    <!-- Application Logic -->
    <script>
        // --- DATA STORE ---
        const satData = [
            {
                id: "words-in-context",
                title: "Words in Context",
                category: "Craft & Structure",
                description: "Determine the meaning of a word or phrase based on its context within a passage.",
                strategies: `
                    <p>These questions test vocabulary and nuance. Avoid picking definitions just because they are common.</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. The Blank Method</strong>
                            Cover the choices. Read the sentence and guess your own word based on clues. Then find the match.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. Polarity Check</strong>
                            Is the missing word positive (+), negative (-), or neutral? Look for words like "however" or "and" to guide you.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Plug It In</strong>
                            Read the full sentence with each choice. Eliminate those that create logical contradictions.
                        </li>
                    </ul>
                `,
                traps: [
                    "Choosing a word because it 'sounds sophisticated'.",
                    "Ignoring secondary meanings of common words.",
                    "Overlooking 'tone' keywords."
                ],
                skillProfile: [90, 60, 20, 30, 80],
                tip: "Focus on words *immediately surrounding* the blank. They often contain the synonym."
            },
            {
                id: "text-structure",
                title: "Structure & Purpose",
                category: "Craft & Structure",
                description: "Analyze the overall structure or identify the main purpose of a text.",
                strategies: `
                    <p>Step back and look at the "Big Picture". Don't get lost in the details.</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. The 'Why' Filter</strong>
                            Why did the author write this sentence? To introduce, refute, or conclude?
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. Identify the Shift</strong>
                            Look for "But," "However," or "Although." The main point is usually <em>after</em> the shift.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Verb Matching</strong>
                            Do the answer verbs (e.g., "criticize," "explain") match the passage's tone?
                        </li>
                    </ul>
                `,
                traps: [
                    "Selecting a true detail that isn't the *main* point.",
                    "Confusing a character's opinion with the narrator's."
                ],
                skillProfile: [30, 90, 20, 50, 60],
                tip: "Read the first and last sentence carefully. The Purpose is usually bookended there."
            },
            {
                id: "cross-text",
                title: "Cross-Text Connections",
                category: "Information & Ideas",
                description: "Synthesize information from two distinct texts to find relationships.",
                strategies: `
                    <p>You are a mediator between two authors. Be neutral.</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. Summarize First</strong>
                            Mentally summarize: "Text 1 says X, Text 2 says Y."
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. Define Relationship</strong>
                            Is it Agreement? Disagreement? Or Qualification (Agree with a 'but')?
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Point of Contact</strong>
                            Identify exactly <em>what</em> topic they share. Eliminate choices discussing unique topics.
                        </li>
                    </ul>
                `,
                traps: [
                    "Assuming total disagreement based on one minor point.",
                    "Using outside knowledge."
                ],
                skillProfile: [40, 95, 20, 80, 50],
                tip: "For 'How would Author 1 respond?', adopt Author 1's persona strictly."
            },
            {
                id: "transitions",
                title: "Transitions",
                category: "Expression of Ideas",
                description: "Select the word that logically connects two sentences.",
                strategies: `
                    <p>This is pure logic. How does Sentence B relate to Sentence A?</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. The 'No-Option' Test</strong>
                            Read without any transition. Does it continue, contradict, or result?
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. Categorize</strong>
                            Group choices: Continuation (Also), Contrast (However), Causation (Thus).
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Eliminate Synonyms</strong>
                            If 'Furthermore' and 'Moreover' are both options, both are likely wrong.
                        </li>
                    </ul>
                `,
                traps: [
                    "Picking what 'sounds smooth' but has wrong logic.",
                    "Ignoring punctuation clues."
                ],
                skillProfile: [50, 85, 40, 20, 80],
                tip: "Cross out the transition word and read the bare sentences to see the naked logic."
            },
            {
                id: "rhetorical-synthesis",
                title: "Rhetorical Synthesis",
                category: "Expression of Ideas",
                description: "Synthesize notes into a sentence achieving a specific goal.",
                strategies: `
                    <p>A matching game. The prompt's command is the only thing that matters.</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. Identify Goal</strong>
                            Underline the command: "The student wants to [emphasize location]..."
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. Match Goal to Choice</strong>
                            Find the choice that explicitly does that. If it asks for location, pick the one with a city/country.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Ignore Missing Info</strong>
                            It doesn't matter if the answer leaves out other bullet points.
                        </li>
                    </ul>
                `,
                traps: [
                    "The 'Summary' trap (picking the choice with the most info).",
                    "Ignoring the specific command."
                ],
                skillProfile: [20, 70, 30, 90, 95],
                tip: "The prompt is King. Obey the command literally."
            },
            {
                id: "form-structure-sense",
                title: "Form, Structure, Sense",
                category: "Standard English Conventions",
                description: "Correct errors in grammar (Subject-Verb, Pronouns, Modifiers).",
                strategies: `
                    <p>Trust the rules, not your 'ear'.</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. Locate Subject</strong>
                            Find the main noun. Ignore prepositional phrases. Match S/S or P/P.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. Check Tense</strong>
                            Keep tense consistent with surrounding verbs unless there's a time shift.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Dangling Modifiers</strong>
                            "Walking down the street, the dog..." (The modifier must touch the noun it describes).
                        </li>
                    </ul>
                `,
                traps: [
                    "Thinking 'Data' is singular (treat strict agreement).",
                    "Confusing 'Its' vs 'It's'."
                ],
                skillProfile: [10, 30, 95, 10, 70],
                tip: "Short is sweet. If grammar is correct, the shortest answer is usually right."
            },
            {
                id: "boundaries",
                title: "Boundaries",
                category: "Standard English Conventions",
                description: "Use punctuation to link clauses correctly.",
                strategies: `
                    <p>Focus on separating Independent Clauses (sentences that stand alone).</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. Period/Semicolon Rule</strong>
                            A semicolon (;) equals a period (.). If choices differ only by this, both are wrong.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. The Colon (:)</strong>
                            Needs a full sentence BEFORE it. What follows can be anything.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Comma Splices</strong>
                            NEVER join two full sentences with just a comma. Need Comma + FANBOYS.
                        </li>
                    </ul>
                `,
                traps: [
                    "Using a comma before 'that'.",
                    "Unpaired dashes."
                ],
                skillProfile: [10, 40, 90, 10, 85],
                tip: "Exaggerate pauses when reading. Periods are stops. Commas are pauses."
            },
            {
                id: "texts",
                title: "Command of Evidence",
                category: "Information & Ideas",
                description: "Determine which evidence best supports a claim.",
                strategies: `
                    <p>Act as a lawyer proving a case.</p>
                    <ul class="list-none space-y-4 mt-2">
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">1. Isolate Claim</strong>
                            Underline the specific hypothesis you need to support.
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">2. Prediction</strong>
                            What would proof look like? "I need a quote showing X increases Y."
                        </li>
                        <li class="pl-0">
                            <strong class="text-blue-700 block mb-1">3. Eliminate Irrelevance</strong>
                            Discard choices that quote text accurately but prove a <em>different</em> point.
                        </li>
                    </ul>
                `,
                traps: [
                    "Matching keywords without matching logic.",
                    "Confusing archaic language in poetry."
                ],
                skillProfile: [70, 80, 20, 95, 40],
                tip: "For graph questions, look for outliers or highest/lowest points."
            }
        ];

        // --- APP STATE ---
        let currentThemeIndex = 0;
        let masteredThemes = new Set();
        let radarChartInstance = null;

        // --- ELEMENTS ---
        const sidebarNav = document.getElementById('sidebar-nav');
        const mobileNav = document.getElementById('mobile-nav');
        const welcomeView = document.getElementById('welcome-view');
        const themeView = document.getElementById('theme-view');
        
        // Theme Elements
        const themeTitle = document.getElementById('theme-title');
        const themeDesc = document.getElementById('theme-description');
        const themeCat = document.getElementById('theme-category');
        const strategyContent = document.getElementById('strategy-content');
        const trapsList = document.getElementById('traps-list');
        const proTip = document.getElementById('pro-tip');
        const markMasteredBtn = document.getElementById('mark-mastered-btn');
        const masteredIcon = document.getElementById('mastered-icon');
        const masteredText = document.getElementById('mastered-text');
        
        // Progress
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');

        // --- INIT ---
        function init() {
            renderNav();
            updateProgress();
            
            // Check for saved state (optional local storage could go here)
        }

        // --- NAVIGATION RENDERING ---
        function renderNav() {
            sidebarNav.innerHTML = '';
            mobileNav.innerHTML = '<option value="" disabled selected>Select a Theme</option>';

            satData.forEach((theme, index) => {
                // Desktop Sidebar Button
                const btn = document.createElement('button');
                btn.className = `theme-btn w-full text-left px-4 py-3 rounded-md text-sm font-medium text-slate-600 border-l-4 border-transparent transition-all mb-1 hover:bg-slate-50`;
                btn.innerHTML = `
                    <div class="flex justify-between items-center">
                        <span>${theme.title}</span>
                        ${masteredThemes.has(theme.id) ? '<span class="text-emerald-500 font-bold">&#10003;</span>' : ''}
                    </div>
                `;
                btn.onclick = () => loadTheme(index);
                sidebarNav.appendChild(btn);

                // Mobile Option
                const opt = document.createElement('option');
                opt.value = index;
                // Add checkmark symbol to text if mastered
                opt.text = (masteredThemes.has(theme.id) ? "✓ " : "") + theme.title;
                mobileNav.appendChild(opt);
            });

            // Mobile Nav Event Listener
            mobileNav.onchange = (e) => loadTheme(parseInt(e.target.value));
        }

        // --- LOAD CONTENT ---
        function loadTheme(index) {
            currentThemeIndex = index;
            const data = satData[index];

            // UI Switch
            welcomeView.classList.add('hidden');
            themeView.classList.remove('hidden');
            
            // Highlight Desktop Nav
            const navBtns = document.querySelectorAll('.theme-btn');
            navBtns.forEach((btn, i) => {
                if(i === index) btn.classList.add('active');
                else btn.classList.remove('active');
            });

            // Sync Mobile Select (if loaded via Desktop click)
            mobileNav.value = index;

            // Populate Text Content
            themeTitle.textContent = data.title;
            themeDesc.textContent = data.description;
            themeCat.textContent = data.category;
            strategyContent.innerHTML = data.strategies;
            proTip.textContent = data.tip;

            // Populate Traps List
            trapsList.innerHTML = '';
            data.traps.forEach(trap => {
                const li = document.createElement('li');
                li.className = "flex items-start gap-2";
                li.innerHTML = `<span class="text-rose-400 mt-1">•</span> <span>${trap}</span>`;
                trapsList.appendChild(li);
            });

            // Update Mastered Button UI
            updateMasteredButtonState(data.id);

            // Button Logic
            markMasteredBtn.onclick = (e) => {
                e.preventDefault(); // Prevent double taps causing issues
                toggleMastered(data.id);
            };

            // Render/Update Chart
            renderChart(data.skillProfile);

            // Scroll Logic: Only scroll main content to top, not whole body (keeps header visible)
            // On mobile, scroll to the theme start
            const mainArea = document.getElementById('main-content-area');
            if(window.innerWidth < 768) {
                // Scroll window to just below the sticky nav
                 window.scrollTo({ top: 100, behavior: 'smooth' });
            } else {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // --- MASTERY LOGIC ---
        function toggleMastered(id) {
            if (masteredThemes.has(id)) {
                masteredThemes.delete(id);
            } else {
                masteredThemes.add(id);
                // Simple confetti effect or feedback could go here
            }
            updateMasteredButtonState(id);
            renderNav(); // Re-render lists to show checkmarks
            
            // Re-apply active class to desktop nav
            const navBtns = document.querySelectorAll('.theme-btn');
            if(navBtns[currentThemeIndex]) navBtns[currentThemeIndex].classList.add('active');

            updateProgress();
        }

        function updateMasteredButtonState(id) {
            if (masteredThemes.has(id)) {
                markMasteredBtn.classList.remove('bg-white', 'text-slate-800', 'border-slate-200');
                markMasteredBtn.classList.add('bg-emerald-50', 'text-emerald-700', 'border-emerald-200');
                masteredIcon.innerHTML = '&#10003;';
                masteredText.textContent = "Mastered";
            } else {
                markMasteredBtn.classList.remove('bg-emerald-50', 'text-emerald-700', 'border-emerald-200');
                markMasteredBtn.classList.add('bg-white', 'text-slate-800', 'border-slate-200');
                masteredIcon.innerHTML = '&#9675;';
                masteredText.textContent = "Mark as Mastered";
            }
        }

        function updateProgress() {
            const percent = satData.length > 0 ? Math.round((masteredThemes.size / satData.length) * 100) : 0;
            progressBar.style.width = `${percent}%`;
            progressText.textContent = `${percent}%`;
        }

        // --- CHART LOGIC ---
        function renderChart(skillData) {
            const ctx = document.getElementById('skillRadarChart').getContext('2d');
            
            if (radarChartInstance) {
                radarChartInstance.destroy();
            }

            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Vocabulary', 'Logic', 'Grammar', 'Evidence', 'Speed'],
                    datasets: [{
                        label: 'Skill Demand',
                        data: skillData,
                        fill: true,
                        backgroundColor: 'rgba(37, 99, 235, 0.2)',
                        borderColor: 'rgb(37, 99, 235)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgb(37, 99, 235)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(37, 99, 235)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { display: true, color: '#e2e8f0' },
                            grid: { color: '#e2e8f0' },
                            pointLabels: {
                                font: { size: 10, family: "'Inter', sans-serif", weight: '600' },
                                color: '#64748b'
                            },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: { display: false, stepSize: 25 }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            padding: 10,
                            cornerRadius: 8,
                            titleFont: { family: "'Inter', sans-serif" },
                            bodyFont: { family: "'Inter', sans-serif" }
                        }
                    }
                }
            });
        }

        // --- START ---
        init();

    </script>
</body>
</html>
